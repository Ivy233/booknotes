# 第一章 概述
## 1.1 计算机网络在信息时代中的作用
+ 有三大类很熟悉的网络，即`电信网络`，`有线电视网络`和`计算机网络`。
    + 电信网络向用户提供电话、电报和传真等服务。
    + 有线电视网络顾名思义
    + 计算机网络负责在计算机中传输数据。
+ 三网合一是一种趋势，但是要做到并不简单，因为这涉及到各方面经济利益和行政管辖权的问题。
+ 互联网的基本特点是`连通性`和`共享`。
    + 连通性指不管距离多远，互联网都可以让上网用户之间交换信息，`好像`是直接连通的一样。
    + 共享就是可以共享硬件，软件或者信息之类的资源。
## 1.2 互联网概述
### 1.2.1 网络的网络
+ 计算机网络由若干`结点`和连接这些结点的`链路`组成。
    + 结点可以是计算机、集线器、交换机、路由器等等。
+ 注意`互连网`的概念是通过路由器把一些较小的网络互连起来的网络。
+ 网络把许多计算机连接在一起，而互连网把许多网络通过路由器连接在一起。与网络相连的计算机常称为主机。
### 1.2.2 互联网基础结构发展的三个阶段
1. 第一阶段是单个网络ARPANET向`互连网`发展的过程。ARPANET在1969年创立，在1990年关闭，最初只是一个单个的分组交换网。在1983年TCP/IP成为ARPANET的标准协议。
    + internet(互连网)是一个`通用名词`，泛指多个计算机网络互连而成的计算机网络，通信协议任意选择，不一定是TCP/IP。
    + Internet(互联网)是一个`专用名词`，采用TCP/IP协议族作为通信规则，前身是ARPANET。
2. 第二阶段是建成了三级结构的互联网NSFNET。1985年起NSF就围绕六个大型计算机中心建设计算机网络，整个网络分为三级: `主干网`、`地区网`和`校园网(企业网)`。
3. 第三阶段是逐渐形成了多层次ISP结构的互联网。1993年开始，NSFNET逐渐被商用的互联网主干网替代，出现新的名词: `互联网服务提供者ISP`。ISP又称为`互联网服务提供商`。
    + ISP也分由不同的层次: `主干ISP`，`地区ISP`和`本地ISP`。`主干ISP`由几个专门的公司创建和维持，有高速主干网，有一些`地区ISP`可以直接连接`主干ISP`；`本地ISP`给用户提供直接的服务，可以是由很小范围的进行运作，比如高校，企业，提供小型互联网服务的公司。
    + IXP的出现允许两个网络直接相连并交换分组，而不需要通过第三个网络来转发分组。一般来说IXP链接两个对等交换分组的时候互相不收费，但是连接到更高级IXP的时候需要收费。
### 1.2.3 互联网的标准化工作
1. 互联网不再归美国政府管辖，因此成立了一个国际性组织叫互联网协会ISOC，ISOC下有一个组织叫互联网体系结构委员会IAB，负责管理互联网相关协议的开发。IAB有两个工程部。
   + 互联网工程部IETF主要负责短期或中期的工程问题，针对协议的开发和标准化。
   + 互联网研究部IRTF主要负责长期考虑的问题，包括一些协议、应用和体系结构等。
2. 互联网的正式标准分为三个阶段，互联网草案，建议标准(RFC文档)和互联网标准(STD xx)，在RFC 6410(2011年10月)取消了互联网草案。
3. RFC文档分为五种: 建议标准，互联网标准，历史的，实验的和提供信息的。RFC中如果提到了之前的RFC，则应当提供索引。
## 1.3 互联网的组成
+ 互联网划分为以下两大块: 边缘部分(用户直接使用，通信和资源共享)和核心部分(路由器，服务器，主干网)。
### 1.3.1 互联网的边缘部分
+ 我们称主机A和主机B进行通信，实际上是说`主机A的某个进程在和主机B的某个进程进行通信`，可以被简称为`计算机之间通信`。
+ 网络边缘的端系统可以分为两个通信方式: CS(客户端-服务器)方式和P2P方式。
+ CS模式的内容就是:
    + A运行客户端，B运行服务端，A向B发送请求，B反过来给A提供服务，这时A为客户端，B为服务器。
    + 客户是服务请求方，服务器是服务提供方。
    + 一般来说，客户端机器要求不高，由客户调用运行并发送信息。
    + 服务器对配置要求高，系统启动时自动调用，被动接受客户端发送的信息，处理并返回内容。
+ P2P方式中，双方产生连接以后可以对等下载，这个时候一台主机可以同时作为主机也可以作为服务器。
### 1.3.2 互联网的核心部分
+ 网络的核心部分的主要工作是为大量主机提供连接性，使边缘部分的任意一台主机可以和其他主机通信。
+ 网络的核心部分起特殊作用的是路由器。路由器是实现分组交换的关键构件，其任务是转发收到的分组。
1. 电路交换
    + 电路交换起步于电话，直接链接两个可交换信息的容器，
        + 一个重要特点是在连接的全部时间内，双方始终占用这条线路的通信资源。
        + 除此以外，电路交换必须经过建立连接->通信->释放连接的三个步骤。
    + 考虑到计算机的特点是突发传输，其线路的传输效率往往很低。
2. 分组交换
    + 分组交换采用存储转发技术，利用包头来区分发送者，接收者，这是第几个包等附加信息来分割、标记更小的登场片段，分别发送(可以是向不同地方发送，也可以类似于电路交换一样发送)。
    + 分组交换中，如果一条线路出现问题(故障，ping太高之类)，会自动换掉这一小段，并由下一个路由重新确定到终点的最优路径。具体的选择方式则由路由选择协议确定。
    + 分组交换有缺点。
        + 分组在存储转发的时候需要排队，这就会造成一定的时延。
        + 控制信息会带来额外的网络开销。
        + 控制机制需要适配这个网络。
    + 分组交换的优点如下表

优点 | 所采用的手段
---- | ----------
高效 | 在分组传输的过程中动态分配传输带宽，堆通信链路是逐段占用
灵活 | 为每一个分组独立选择最合适的转发路由
迅速 | 以分组为传送单位，可以不先建立连接就能向其他主机发送分组
可靠 | 保证可靠性的网络协议；分布式多路有的分组交换网
3. 报文交换:  以一份电报为单位进行类似于分组交换的方式进行转发，在计算机中则为整个文件。
## 1.4 计算机网络在我国的发展
+ 中国规模最大的就是: 中国电信互联网CHINANET，中国联通互联网UNINET，中国移动互联网CMNET，中国教育和科研计算机网CERNET，中国科学技术网CSTNET
## 1.5 计算机网络的类别
### 1.5.1 计算机网络的定义
+ 计算机网络的定义并未统一，当前较好的定义是这样的: 计算机网络主要是由一些通用的，可编程的硬件互联而成的，而这些硬件并非专门用来实现某一特定目的。这些可编程硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用。
### 1.5.2 几种不同的计算机网络
#### 按照网络的作用范围分类
+ 广域网WAN: 范围以km计，是互联网的核心部分，长距离传输数据。
+ 城域网MAN: 一般是一个城市的范围，也有可能是几个街区，可以为一个单位或几个拥有，也可以是一种公用设施，有时也并入局域网讨论。
+ 局域网LAN: 地理上局限在比较小的范围，速度比较高。
+ 个人局域网PAN: 范围极小
+ 如果中央处理机之间的距离非常近，则一般称之为多处理机系统而不是计算机网络
#### 按照网络的使用者进行分类
+ 公用网: 国有或私有企业出资建造的大型网络，只要按照规定缴纳费用的都可以使用。
+ 专用网: 给本单位的特殊业务工作需要适配的网络，一般不需要给外界适配。
#### 接入网
+ 通常称为本地接入网或居民接入网。
## 1.6 计算机网络的性能
### 1.6.1 计算机网络的性能指标
+ 速率: 指数据的传送速率，也成为数据率，单位为bit/s，注意这是额定速率或者说标称速率。
+ 带宽: 有两种不同的含义，分别是某个信号具有的频带宽度，单位Hz，与某通道传输数据的能力，单位bit/s，
+ 吞吐量: 单位时间内通过某个网络(或信道、接口)的实际的数据量。一个1000Mbps的网络可能实际吞吐量大约100Mbit/s，因为并未达到额定功率。
+ 时延分为四种时延。
   + 发送时延是主机或路由器发送数据帧所需要的时间，计算方法为数据帧长度和发送数据的商。
   + 传播时延是电磁波在信道中传播一定的距离需要花费的时间，是信道长度和电磁波传播速率的商。
   + 处理时延是主机或者路由器需要花费一定的时间进行处理，例如分析分组的首部，提取数据，CRC校验或找到适当的路由。
   + 排队时延是因为在分组传递的时候，路由器还有其他的包需要处理，这就产生了排队时间。
+ 时延带宽积是传播时延与带宽的乘机，表示管道的体积(仅仅是某种程度上的)，或者是以比特为单位的链路长度。
+ 往返时间RTT是两倍的传播时延和排队时延的总和。通常用于计算有效数据率。在互联网中，往返时间还包括各中间节点的处理时延，排队时延和转发数据时的发送时延，不过通常数据很短，可以忽略掉发送时延。
+ 利用率有信道利用率和网络利用率两种。前者是指时间上有多少百分比的时间通过了数据，后者是全网络信道利用率的加权平均值。在利用率增加的时候传输其他包的时间会增加。其中有一个公式`D = D0 / (1 - U)`来表示空闲时延，实际时延和利用率的区别。
### 1.6.2 计算机网络的非性能特征
+ 费用
+ 质量指一段时间以后能否达到要求。
+ 可靠性
+ 可扩展性
+ 管理与维护
## 1.7 计算机网络体系结构
### 1.7.1 计算机网络体系结构的形成
+ 计算机之间必须有一条传输数据的通路，但是这还不够，还需要一些东西来保证内容。
    + 发起通信的计算机必须将数据通信的通路进行激活。
    + 要告诉网络如何识别接受数据的计算机。
    + 发起通信的计算机必须查明对方计算机是否开机，并且保证连接正常。
    + 发起通信的计算机中的进程必须弄清楚，对方的文件管理程序是否准备好接受文件。
    + 如果文件格式不兼容，那么必须要格式转换功能。
    + 对于各种差错和意外事故，需要有可靠性保证措施来保证最终收到正确的文件。
+ 在一个公司中可以很轻易的保证互相连接，但是对于不同公司则很容易产生兼容问题，这个时候就需要统一协议。
+ 国际标准化组织ISO在1977年提出了OSI/RM协议，开放而且标准，只要符合这个协议就可以和另外一台支持这个协议的计算机进行通信。
+ OSI虽然得到了很多支持，也试图足够优秀，但是在90年代初制定出来的时候，已经被TCP/IP抢占了足够多的市场。所以人们说`OSI只获得了一些理论上的成果，但是市场化事与愿违地失败了。`有人总结了OSI的缺点:
    + OSI的专家们缺乏实际经验，在完成OSI标准的时候缺乏商业区动力。
    + OSI的协议实现起来过分复杂，运行效率较低。
    + OSI的制定周期太长，设备无法及时进入市场。
    + OSI的层次划分不太合理，有功能在多个层次中重复出现。
### 1.7.2 协议与划分层次
+ 计算机网络想要做到有条不紊的交换数据，就必须遵守一些事先约定好的规则，这些规则明确规定了所交换的诗句格式以及有关的同步问题。这里的同步是广义的，即在一定的条件下应当发生什么事件，因而含有时序的意思。这些为进行网络中的数据交换而建立的规则、标准或约定被称为网络协议，其主要由三个要素组成:
    + 语法，即数据与控制信息的结构与格式
    + 语义，即需要发出何种控制信息，完成何种动作以及做出何种响应。
    + 同步，即事件实现顺序的详细说明。
+ 注意，操作自己电脑装载硬盘的数据不需要网络协议，除非你操作的是远程服务器的硬盘。
+ 协议分两种格式，一种是人可以读的，一种是计算机可以读的。
+ 分层带来的好处。
    + 各层之间是独立的，某一层并不知道下一层如何实现，只需要提供接口就行了。
    + 灵活性好。只要接口关系保持不变，这层上面和下面都可以不受影响，甚至可以修改甚至取消。
    + 结构上可分割开。
    + 易于实现和维护。总不能让一个人负责很大的部分吧。
    + 能促进标准化工作。
+ 各层的主要工作是，这可能有一层，也可能有多层。
    + 差错控制。使对应层次对等方的通信更加可靠。
    + 流量控制。发送速率必须来得及接受。
    + 分段与重装。在发送端划分为更小的单位，在接收端将其还原。
    + 复用和分用。发送端几个高层绘画复用一条底层的链接，在接收端将其还原。
    + 连接建立与释放。
+ 计算机网络的各层及其协议的集合就是网络的体系结构。
    + 计算机网络的体系结构就是这个计算机网络及其构件所应完成的功能的精确定义。
    + 体系结构是抽象的，实现则是具体的，是真正在运行的计算机硬件和软件。
### 1.7.3 具有五层协议的体系结构
+ OSI的问题之前有过讲述。TCP/IP则是四层的协议，包括应用层，运输层，网际层和网络接口层。不过实际上TCP/IP则是前三层有用，最后一层没啥东西。教学的结构则采取了五层协议。TCP/IP中的TCP和IP协议相当出名，因此采用了这两个作为名字。
+ 应用层
    + 体系结构的最高层。
    + 通过应用进程之间的交互来完成特定网络应用。
    + 协议定义的是应用进程之间通信和交互的规则。这里的进程指的是正在运行的程序
    + 经典协议：DNS域名系统，HTTP协议，SMTP协议。
    + 在应用层之间流动的数据单元成为报文。
+ 运输层[也有人说这是传输层]
    + 负责向两台主机的进程之间的通信提供通用的数据传输服务。
    + 应用进程通过该服务传送报文。
    + 经典协议：TCP传输控制协议，数据单位是报文段；UDP用户数据报协议，传输单位是用户数据报。
    + 一台主机之间有多个进程，所以运输层有复用和分用的功能。
+ 网络层
    + 负责为分组交换网上的不同主机进行服务，发送数据时，报文或者用户数据被分开成分组或包进行发送。
    + 在TCP/IP中，由于使用IP协议，所以被称为IP数据报。`这本书把分组和数据报作为同一个东西，与此同时，把网络层，网际层和IP层当作同一个东西`。
    + 互联网是由大量的异构网络通过路由器连接起来的。
    + 经典协议：IP协议，路由选择协议
+ 数据链路层[链路层]
    + 交流单位：帧，由网络层下来的IP数据报组装而成。包含了数据和必要的控制信息(同步信息，地址信息，差错控制等)。
    + 接受数据的时候就解包即可。如果有差错，数据链路层简单地丢弃了出差错的帧。
    + 如果需要修复出差错的帧，就会使链路层的协议变得复杂一些。
+ 物理层
    + 交流单位：bit。双方应当定义0和1代表多少电压。但是0和1是什么意思就不是物理层的任务。
    + 需要确定电缆的插头应当有多少引脚以及引脚如何连接。
+ 除了物理层以外，都给数据加了头，但是只有数据链路层加了尾。
+ OSI参考模型把对等层次之间传递的数据单位称为该层的协议数据单元PDU，这个名词被很多标准引用。
### 1.7.4 实体、协议、服务和服务访问点
+ 当研究开放系统中的信息交换时，往往使用实体这一较为抽象的名词表示任何可发送或接受信息的硬件或软件进程。
+ 协议是控制两个对等实体进行通信的规则的集合。
+ 在协议的控制下，两个对等实体之间的通信使得本层能够像上一层提供服务。要实现本层协议，还需要使用下面一层所提供的服务。
+ 协议是水平的，控制对等实体之间通信的准则。但服务是垂直的，自下而上或者自上而下。当然，只有能够被高一层实体看得见的功能才能称之为服务。
+ 计算机协议有一个很重要的特点，必须把所有不利的条件事先估计到，不能假定一切都是正常的，而且要仔细检查协议能否应付各种异常情况。
### 1.7.5 TCP/IP的体系结构
+ TCP/IP分为四层，图中很显然地说明了一些事情。
    + TCP和UDP向IP发送东西，而所有的协议都在TCP和UDP之上，所以everything over IP。
    + IP over everything。在各种各样的网络上都是IP协议。
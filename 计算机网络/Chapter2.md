# 第二章 物理层
本章最重要的内容是搞清楚
+ 物理层的任务。
+ 了解几种常用的信道复用技术。
+ 了解集中常用的宽带接入技术，主要是ADSL和FTTx。
## 2.1 物理层的基本概念

物理层的协议常常被称为**物理层规程**，或者**物理层协议**。物理层的主要任务是确定与传输媒体端口的接口有关的一些特性。
+ 机械特性。接线器的形状和尺寸，引脚数目和排列，固定和锁定装置等都在此列。
+ 电气特性。各条(引)线的电压范围，
+ 功能特性。在每一条引线上出现的某一电平的电压的定义。
+ 过程特性。不同功能的各种可能事件的出现顺序。

数据在计算机内部多采用**并行传输**方式。但是数据在通信中大部分是**串行传输**。都是钱的问题。
## 2.2 数据通信的基础知识

### 2.2.1 数据通信系统的模型

一个数据通信系统可划分为三大部分，即**源系统**(发送端，发送方都可以)、**传输系统**(传输网络)、**目的系统**(接收端、接收方)。
+ 源系统、目的系统都一般包括两个部分：
    + 源系统包括源点和发送器。源点即产生数据的地方，计算机产生的数字比特流，之后发送器编码以后才能发送出去。典型的发送装置就是调制器，计算机中经常出现。
    
    + 目的系统包括接收器和终点（目的站，信宿）。接收器对于进入的数据进行解调，还原出重点需要的数字比特流。终点把信息通过某种方式输出。
+ 需要注意的是，这里的信息可以是人类可以理解的**消息**，也可以是计算机理解的0101序列，即**数据**。

+ 信号则是数据的电气或电磁表现。具体分为两大类。
    + 模拟信号（连续信号）。通常是以正弦波形式出现，在电线上比较多出现。
    + 数字信号（离散信号）。通常是01（高低电平），代表不同的离散数值的基本波形。
### 2.2.2 有关信道的几个基本概念

注意信道和电路**并不等同**，信道一般都是用来表示向某一个方向传送信息的媒体，因此一条通信电路包含一条发送信道和一条接收信道。从通信的交互方式来看有三种基本方式：
+ 单向通信。比如有线电视，广播。
+ 双向交替通信，双方都可以接受消息，但不能同时发送。比如对讲机
+ 双向同时通信。

来自信源的信号常称为**基带信号**，输出的文字和图片都属于这一类，基带信号通常有很多低频成分，甚至带有直流信号。因此需要对这种信号进行调制以符合基带信号的输出。
+ 第一种方法被称为**编码**，是把数字信号转化成另外一种数字信号，也被称为**基带调制**。
    + 不归零制，正电平代表1，负代表0。
    + 归零制，正脉冲代表1，负脉冲代表0。
    + 曼彻斯特编码，向上跳变为0，向下跳变为1。可以反过来定义。具有自同步能力。
    + 差分曼彻斯特编码，位开始有跳变则为0，反之为1，位中间必定有跳变。
+ 第二种方法被称为**带通调制**。把基带信号的频率范围搬迁到更高的频段，并转换为**模拟信号**，这样就能更好地在模拟信道中传输，转化过后的被称为**带通信号**。
    + 调幅(AM)，载波的**振幅**随基带数字信号变化。
    + 调频(FM)，载波的**频率**随基带数字信号变化。
    + 调相(PM)，载波的**初始相位**随基带数字信号变化。
    + 为了达到更高的信息传输速率，还有更为复杂的技术。

### 2.2.3 信道的极限容量

信道的极限容量必须要考虑的是**数据传输速率**和**长度**，甚至长度和传输速率也是相关的，因为涉及到**失真**的问题。在传输速率越高、传输距离越远、噪声干扰越大、传输媒体质量越差的情况下，越容易发生失真。

从概念上讲，限制码元传输速率的因素有两个：信道能过的频率范围和信噪比。

+ 1924年，Nyquist推出了著名的**奈氏准则**，在任何信道中，码元传输的速率是有上限的，如果超过了这个上限就会导致**码间串扰**问题，识别就成为了不可能。
+ 信道的频带越宽，能通过的高频分量越多，就能用更高的速率传递码元而不发生干扰。
+ 信噪比通常被称为$S/N$，并使用`dB`来作为单位，其意义是信号和噪声的平均功率之比。根据`dB`的计算规则可以知道：$dB=10log_{10}(S/N)$。

在1948年，信息论的创始人香农推导出了著名的**香农公式**，结论是$C=Wlog_2(1+S/N)$。其中

+ `W`是信道的带宽，单位`Hz`。
+ `S`是信道内所穿的平均功率，`N`为信道的高斯噪声功率。
+ `C`是信道的极限传输速率，单位`bit/s`。

实际上，这个上限未免过于高了，又不给出解决方案，到现在都贴不上这个数字。通过给一个码元带更多信息量可以提升传输速率。

## 2.3 物理层下面的传输媒体

传输媒体（传输介质、传输媒介）可分为下述两大类。在导引型传输媒体中，电磁波沿着固体媒体传播，而非导引型媒体则就是指自由空间，比如电磁波的传输。

### 2.3.1 导引型传输媒体

#### 双绞线

把两根互相绝缘的铜导线并排放在一起，然后用规则的方法**绞合**起来就成了双绞线。绞合可以减少对相邻导线的电磁干扰。几乎所有的电话都用双绞线连接到电话交换机，这段从用户电话机到交换机的双绞线被称为**用户线**或者**用户环路**。

双绞线通信距离一般几公里到十几公里。提高抗电磁干扰能力的方法最主要是加屏蔽。这里的数据采集自[Wikipedia]( [https://zh.wikipedia.org/wiki/%E5%8F%8C%E7%BB%9E%E7%BA%BF](https://zh.wikipedia.org/wiki/双绞线) )。

| 类别 | 带宽    | 典型应用                                                     |
| ---- | ------- | ------------------------------------------------------------ |
| 3    | 16MHz   | 语音传输及最高传输速率为10Mbps的数据传输                     |
| 4    | 20MHz   | 基于[令牌](https://zh.wikipedia.org/w/index.php?title=令牌&action=edit&redlink=1)的局域网，10Mbps，100Mbps网络 |
| 5    | 100MHz  | 语音传输和最高传输速率为100Mbps的数据传输                    |
| 5e   | 125MHz  | 一般可以认为支持1Gbps网络，有人检验过可以过10Gbps，但是距离最多50m |
| 6    | 250MHz  | 超过1Gbps的网络，10Gbps通常也可以使用，一般最多100m          |
| 6a   | 500MHz  | 10Gbps网络，标准外径9mm                                      |
| 6e   | 500MHz  | 10Gbps网络，标准外径6mm                                      |
| 7    | 600MHz  | 10Gbps，单线标准外径8mm，多芯线标准外径6mm，必须做屏蔽，因此不建议装修使用 |
| 8    | 2000MHz | 40Gbps网络                                                   |

#### 同轴电缆

这里涉及的就比较少了，同轴电缆由内导体铜质芯线，绝缘层，网状编织的外导体屏蔽层，保护塑料外壳组成。曾经用于网络的连接，现在被光纤和双绞线取代，不过因为抗干扰很好，在影音器材和无线电设备中使用，以保证音频/视频/信号的完整性。

#### 光缆

光纤通常由非常透明的石英玻璃拉成钢丝，主要由纤芯和薄层构成的双层同心圆柱体。纤芯很细，直径只有$8\sim100\mu m$，包层则有较低的折射率，通过全反射减少光的溢出。注意这里纤芯是透明的固体。

+ 单模光纤的纤芯非常细，只有几个微米，成本较高，但是因为非常狭窄，光在其中近乎直线传播，因此几乎不会失真。
+ 多模光纤在多条不同入射角度的光线在一条光纤中传输，在传输过程中会逐渐展宽，造成失真，因此只适合于近距离传输。
+ 通常光纤的三个频段中心为850nm，1300nm和1550nm，其中850衰减比较大但其他特性都不错。

因为光纤非常细，所以可以把很多根放在一起进行传输，并且加入供电线，加入加强芯和填充物可以大大提高机械强度，最后报上包带层和外护套，可以是抗拉强度提升到几公斤。

光纤不仅有通信容量很大的特点，而且传输损耗小，中继距离长；抗雷电和电磁干扰性能好，这在大电流脉冲干扰的环境中尤为重要；没有串音干扰，保密性好；体积小，重量轻。

### 2.3.2 非导引型传输媒体

这里主要讲解的是无线传输，也是**运动中通信的唯一手段**。在现实中紫外线和更高的波段还不能用于通信（把人的DNA打断了怎么办）。剩下的波段中主要利用的波段不同，对应的定位也不同。

#### 短波通信

短波通信主要靠电离层的反射，但是电离层各种不稳定和多径效应导致短波信道的通信质量很差，一般速度很低，大概不到1kbit/s，用上各种调制解调技术以后也不到10kbit/s。

#### 微波通信（300M\~300G，但主要在2\~40G）

微波在空间主要是直线传播，但是在电离层会穿透过去，因此只能贴近地面传送（中继塔），这种方式称为地面微波接力通信，或者在天上弄中转，这种方式称为卫星通信。微波接力通信的范围大概50km，如果天线塔在100m高，可以到100km，这个利用物理知识可以算。大多数长途电话业务使用4~6GHz的频率范围。

微波接力通信可传输电话、电报、图像、数据等信息，其主要特点是

+ 微波频率很高，频段范围也很宽，容量很大。
+ 工业干扰或者电气干扰的主要频谱成分比微波低很多，因此传输质量比较高。
+ 相比于电缆载波通信投资少，见效快。

微波通信也有一些缺点。

+ 相邻站点必须直视，不能有障碍物。
+ 可能会受到恶劣天气的影响。
+ 与电缆通信比较，隐蔽性和保密性较差。
+ 维护需要的人力物力比较多。

#### 卫星通信

卫星通信的传播距离比较远，采用同步卫星或者低轨道卫星作为中继站，在180个同步卫星+不同频段的处理下，传输容量是非常大的。但是卫星通信的传播时延比较大，大概在270ms左右。除此以外，设备复杂，造价昂贵，使用寿命也有限。但是如果受到限制，不能在地面造塔，就只能通过同步卫星。

#### 无线局域网

主要涉及到5G和2.4G网络，具体可以看下[Wifi标准]( https://zh.wikipedia.org/zh/Wi-Fi )。

## 2.4 信道复用技术

### 2.4.1 频分复用FDM、时分复用TDM和统计时分复用STDM

频分复用指在**同样的时间占用不同频率的带宽资源**。时分复用指在**同样的频率下占用一帧内不同时间段的带宽资源**。在进行通信的时候，复用器和分用器总是成对使用，复用器的的作用是把信号放在一起，而分用器则相反。

这里的时分复用解释的还不是很清楚，实际上，一个数据帧里面包含了所有用户的发送的内容，如果这一帧里面这个用户没有发送的内容则留空。可见这一块空间利用率相当低。频分复用也是如此，就算某用户完全没有带宽，也不能让其他用户抢占掉。

#### 统计时分复用

统计时分复用基于时分复用，但是有一定的优化，这种优化基于用户基本都是间歇连接到集中器。大致的逻辑是这样的：

+ 一个复用帧的分割量小于用户数目。
+ 用户有了数据就随时往集中器发送数据。
+ 集中器按照顺序扫描输入缓存，把缓存放进帧里面，没有发送的就跳过去。
+ 一旦发现放满了就发送出去。

这种方法确实提升了利用率，虽然总的数据率小于各输入数据率的综合，但是**从平均的角度来看，确实取得了一个平衡**。不过也有一个问题：就是在全部用户不间断发送数据的时候，集中器肯定无法应付。这种时分复用方式也被称为**异步时分复用**，普通的称为**同步时分复用**。千万要注意的是，课本给的例子每一帧里面只有两个用户发送了数据，实际上，每一帧都可以动态分配时隙。

STDM的缺点除了不能应付全部不间断发送数据以外，还有要对帧进行一些处理，比如加上地址信息，这些开销不可避免。仔细对比教材2-15和2-16的图就可以看出区别。

### 2.4.2 波分复用就是光的频分复用

### 2.4.3 码分复用CDM

基于CDMA技术。每一个客户使用经过特殊挑选的不同码型，因此各个用户之间不会产生干扰。这种系统发送的信号有很强的抗干扰能力，频谱类似于白噪声，不易被敌人发现。这玩意的原理大概是这样的。

+ 在CDMA中，每一个比特时间划分为m个短的间隔，称为码片，通常$m=64$或者$m=128$。
+ 每一个使用CDMA的站都被指派一个唯一的m bit码片序列。如果一个站想要发送1，就发送码片序列，如果要发送0，就发送码片序列**的反码**。
+ 码片之间不能相同，而且必须**正交**。
+ 根据**叠加原理**，在收到一个序列后，和每一个站的码片相乘得到的结果就和发送数据有关。如果是正数那么发送了1，如果是负数发送了0，如果为0就是没发送数据。
+ 需要假设所有站发送的码片序列都是**时间上同步**的，这可以利用GPS做到这一点。

这种通信方式是**扩频通信**中的一种，也是扩频通信中的子类**直接序列扩频(DSSS)**中的一种。另一子类就是**跳频扩频(FHSS)**。

## 2.6 宽带接入技术

### 2.6.1 ADSL技术

以下全部来自于[Wiki-ADSL](https://zh.wikipedia.org/wiki/ADSL)。

ADSL因为上行（从用户到电信服务提供商方向，如上传动作）和下行（从电信服务提供商到用户的方向，如下载动作）带宽不对称（即上行和下行的速率不相同）因此称为**非对称数字用户线路**。它采用**[频分多路复用](https://zh.wikipedia.org/wiki/频分多路复用)**技术把普通的电话线分成了**电话（0\~4kHz）、上行（40\~138kHz）和下行（138kHz\~1100kHz）**三个相对独立的信道，从而避免了相互之间的干扰。通常ADSL在不影响正常电话通信的情况下可以提供最高3.5Mbps的上行速度和最高24Mbps的下行速度。 

ADSL的传输距离取决于**用户的数据率，线径和信噪比**。例如0.5mm的线材，传输速率1.5\~2.0Mbit/s时可传送5.5km，但到了6.1Mbit/s，就只有3.7km，此时再把线径缩小到0.4mm，那么传送距离只有2.7km，不然会造成信号失真。所以一般ADSL要求用户到电话局的距离不超过5km。

ADSL是一种**异步传输模式（ATM）**。

在电信服务提供商端，需要将每条开通ADSL业务的电话线路连接在[数字用户线路访问多路复用器](https://zh.wikipedia.org/wiki/DSLAM)（DSLAM）上。而在用户端，用户需要使用一个ADSL终端（和传统的[调制解调器](https://zh.wikipedia.org/wiki/调制解调器)（Modem）类似）来连接电话线路（在教材上称之为**接入端接单元ATU**，用户这里称为**ATU-R**，本地电话交换机那边称为**ATU-C**）。由于ADSL使用高频信号，所以在两端还都要使用ADSL信号分离器（splitter）将ADSL数据信号和普通音频电话信号分离出来，避免打电话的时候出现噪音干扰。

通常的ADSL终端有一个电话Line-In，一个[以太网](https://zh.wikipedia.org/wiki/以太网)口，有些终端集成了ADSL信号分离器，还提供一个连接的Phone接口。某些ADSL调制解调器使用USB接口与电脑相连，需要在电脑上安装指定的软件以添加虚拟网卡来进行通信。

由于受到传输高频信号的限制，ADSL需要电信服务提供商端接入设备和用户终端之间的距离不能超过5公里，也就是用户的电话线连到电话局的距离不能超过5公里。

ADSL设备在传输中需要遵循以下标准之一：

- ITU-T G.992.1（G.dmt）全速率，下行8Mbps，上行896Kbps
- ITU-T G.992.2（G.lite）下行1.5Mbps，上行512Kbps
- ITU-T G.994.1（G.hs）可变比特率（VBR）
- ANSI T1.413 Issue #2 下行8Mbps，上行896Kbps

还有一些更快更新的标准（ADSL2/ADSL2+）这些标准相对于第一代有所改进，但是当前还很少有电信服务提供商使用。改进的地方主要在于可以使用更高的频段和采用了**无缝速率自适应技术SRA**，以及改善了线路质量评测和故障定位功能（为啥感觉这不能算）。

- ITU G.992.3/4 **ADSL2**下行12Mbps，上行1.0Mbps
- ITU G.992.3/4 **Annex J ADSL2**下行12Mbps，上行3.5Mbps
- ITU G.992.5 **ADSL2+** 下行24Mbps，上行1.0Mbps
- ITU G.992.5 **Annex M ADSL2+** 下行24Mbps，上行3.5Mbps

ADSL2+还可以支持线路bonding的方式，也就是给终端用户提供多个线路，总带宽是单个线路带宽的累计.支持bonding方式的应用很少，技术方面详见G.998.x或G.bonding。

当电信服务提供商的设备端和用户终端之间距离小于1.3公里的时候，还可以使用速率更高的[VDSL](https://zh.wikipedia.org/wiki/VDSL)，它的速率可以达到下行55.2Mbps，上行19.2Mbps。

### 2.6.2 光纤同轴混合网(HFC)

这是在有线电视网络的基础上开发的一款居民宽带接入网，除了可以传送电视节目以外，还可以提供电话、数据服务。光纤从头端连接到光线结点，然后通过同轴电缆连接到每一个用户，把到用户的放大器减少到4\~5个，连接到一个光纤结点的用户数目在500\~2000个。光线结点到头端的典型距离在25km，到用户则不超过3km。

现在的HFC设置了5\~65MHz的上行信道，87\~1000MHz的下行信道，这是根据GB/T 17786-1999来的。

模拟电视机接受数字电视信号需要一个机顶盒，连在同轴电缆和电视机之间。为了用户能利用HFC王接入互联网，以及在上行信道中传送交互数字电视所需的一些信息，还需要增加一个为HFC专用的调制解调器（**电缆调制解调器**）。这种调制解调器不需要成对使用，但是配置复杂得多，因为必须解决共享信道可能的冲突问题。

相比于ADSL的线路专用，HFC的电缆是公用的，所以大部分情况下达不到宣称的最高速度，因为那是少数几个人同时使用才可以达成。

### 2.6.3 FTTx技术

其中的x代指各种位置的缩写，比如家庭Home的技术就是FTTH。在大多数人的眼中，光纤的速度很快，所以都希望配置一根光纤到家门口，实际上这并不是最优的选择，至少不可能独占一根光纤。

所以就产生了一个光配线网ODN使得数十个家庭用户能够共享一根光纤干线。具体教材已经给了实例。特别地，没有电源供给的ODN称为无源光网络PON。ODN采用波分复用，上下行分别使用不同的波长。

PON的种类很多，但是最流行的有以下两种：

+ 以太网无源光网络EPON。
+ 吉比特无源光网络GPON。